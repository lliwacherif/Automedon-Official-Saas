import{u as v}from"./useCars-B100C04u.js";import{d as b,$ as w,V as k,e as s,o as a,g as e,C as _,h as D,j as r,a5 as C,i as o,f as j,F as u,n as T,H as V}from"./index-6E32DxFF.js";import{a as f}from"./date-BpD5EXL9.js";import{L as F}from"./loader-circle-ivbMhOq-.js";const N={class:"p-6"},L={class:"flex justify-between items-center mb-6"},P={class:"text-2xl font-bold text-gray-800 flex items-center"},S={key:0,class:"flex justify-center py-12"},$={key:1,class:"bg-white shadow-md rounded-lg overflow-hidden"},B={class:"overflow-x-auto"},H={class:"min-w-full divide-y divide-gray-200"},I={class:"bg-white divide-y divide-gray-200"},M={key:0},R={class:"px-6 py-4 whitespace-nowrap"},q={class:"text-sm font-medium text-gray-900"},z={class:"text-sm font-bold text-gray-700"},A={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-bold"},E={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-bold"},J={class:"px-6 py-4 whitespace-nowrap"},G={class:"text-sm font-medium text-gray-900"},K={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono"},O={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Q={key:0,class:"text-green-600 font-bold"},U={key:1,class:"text-red-600 font-bold"},W={key:1},X={class:"px-6 py-4 whitespace-nowrap text-sm"},ae=b({__name:"DailyJournal",setup(Y){const{t:d}=w(),{cars:c,loading:m,fetchCars:y}=v();k(()=>{y()});function g(n){return n?n.replace(/(\d+)(TN)(\d+)/i,"$1 $2 $3"):""}function p(n){if(n.status!=="loue"||!n.active_reservation)return{text:d("admin.fleet.disponible"),class:"bg-green-100 text-green-800 border border-green-200 font-bold"};const i=new Date;i.setHours(0,0,0,0);const t=n.active_reservation;if(!t.end_date)return{text:"-",class:""};const x=new Date(t.end_date);x.setHours(0,0,0,0);const h=x.getTime()-i.getTime(),l=Math.ceil(h/(1e3*60*60*24));return l===1?{text:d("daily_journal.return_tomorrow"),class:"bg-red-100 text-red-800 border border-red-200 font-bold"}:l===2?{text:d("daily_journal.return_after_tomorrow"),class:"bg-orange-100 text-orange-800 border border-orange-200 font-bold"}:l>2?{text:new Date(t.end_date).toLocaleDateString("fr-FR"),class:"bg-green-100 text-green-800 border border-green-200 font-bold"}:l===0?{text:d("daily_journal.return_today"),class:"bg-red-600 text-white font-bold animate-pulse"}:{text:d("daily_journal.late"),class:"bg-red-800 text-white font-bold"}}return(n,i)=>(a(),s("div",N,[e("div",L,[e("h1",P,[_(r(C),{class:"w-8 h-8 mr-3 text-indigo-600"}),D(" "+o(r(d)("daily_journal.title")),1)])]),r(m)?(a(),s("div",S,[_(r(F),{class:"animate-spin h-8 w-8 text-indigo-600"})])):(a(),s("div",$,[e("div",B,[e("table",H,[i[1]||(i[1]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Voiture & Plaque "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Début "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Fin "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Client "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contract ID "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Paiement "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut ")])],-1)),e("tbody",I,[r(c).length===0?(a(),s("tr",M,[...i[0]||(i[0]=[e("td",{colspan:"6",class:"px-6 py-4 text-center text-gray-500"}," Aucun véhicule dans la flotte. ",-1)])])):j("",!0),(a(!0),s(u,null,T(r(c),t=>(a(),s("tr",{key:t.id,class:"hover:bg-gray-50"},[e("td",R,[e("div",q,o(t.brand)+" "+o(t.model),1),e("div",z,o(g(t.plate_number)),1)]),e("td",A,o(t.active_reservation?r(f)(t.active_reservation.start_date):"-"),1),e("td",E,o(t.active_reservation?r(f)(t.active_reservation.end_date):"-"),1),e("td",J,[e("div",G,o(t.active_reservation?t.active_reservation.client_name:"-"),1)]),e("td",K,o(t.active_reservation&&t.active_reservation.contract_number||"-"),1),e("td",O,[t.active_reservation?(a(),s(u,{key:0},[t.active_reservation.total_price-t.active_reservation.advance_payment<=0?(a(),s("span",Q," Payé ")):(a(),s("span",U," Reste: "+o((t.active_reservation.total_price-t.active_reservation.advance_payment).toFixed(2))+" DT ",1))],64)):(a(),s("span",W,"-"))]),e("td",X,[e("span",{class:V([p(t).class,"px-2 py-1 inline-flex text-xs leading-5 rounded-full"])},o(p(t).text),3)])]))),128))])])])]))]))}});export{ae as default};
