import{u as f}from"./useReservations-vuFAFkz7.js";import{c as _,d as v,$ as b,a0 as w,V as k,e as c,o as d,g as t,j as a,C as x,h as C,f as D,F as T,n as F,i as r,E as j,a1 as L}from"./index-BgCL6C0w.js";import{a as u}from"./date-BpD5EXL9.js";import{L as V}from"./loader-circle-DR73HpBo.js";import{S as $}from"./square-pen-C84BIWF1.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=_("FileDownIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function R(){function y(g,o){if(!o||!o.length)return;const l=";",p=Object.keys(o[0]),m=[p.join(l),...o.map(i=>p.map(e=>{let s=i[e]===null||i[e]===void 0?"":i[e];return s=s instanceof Date?s.toLocaleString():s.toString().replace(/"/g,'""'),s.search(/("|,|\n)/g)>=0&&(s=`"${s}"`),s}).join(l))].join(`
`),h=new Blob(["\uFEFF"+m],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");if(n.download!==void 0){const i=URL.createObjectURL(h);n.setAttribute("href",i),n.setAttribute("download",g),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}return{exportToCsv:y}}const S={class:"p-6"},I={class:"flex justify-between items-center mb-6"},M=["disabled"],N={key:0,class:"flex justify-center py-12"},q={key:1,class:"bg-white shadow-md rounded-lg overflow-hidden"},B={class:"overflow-x-auto"},P={class:"min-w-full divide-y divide-gray-200"},A={class:"bg-white divide-y divide-gray-200"},O={key:0},U={class:"px-6 py-4 whitespace-nowrap"},z={class:"text-sm font-medium text-gray-900"},H={class:"text-xs text-gray-500"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},G={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},J={class:"px-6 py-4 whitespace-nowrap"},K={class:"text-sm font-medium text-gray-900"},Q={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},W={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ot=v({__name:"ReservationsTable",setup(y){const{t:g}=b(),{reservations:o,loading:l,fetchReservations:p}=f(),{tenantPath:m}=w(),{exportToCsv:h}=R();function n(){const i=o.value.map(e=>({"Voiture & Plaque":`${e.car?.brand} ${e.car?.model}
${e.car?.plate_number}`,"Date Début":u(e.start_date),"Date Fin":u(e.end_date),Client:e.client_name,"Coût Total":`${e.total_price.toFixed(2)} TND`,"Contract ID":e.contract_number||""}));h(`reservations_${new Date().toISOString().split("T")[0]}.csv`,i)}return k(()=>{p()}),(i,e)=>(d(),c("div",S,[t("div",I,[e[1]||(e[1]=t("h1",{class:"text-2xl font-bold text-gray-800"},"Tableau des Réservations",-1)),t("button",{onClick:n,disabled:a(l)||a(o).length===0,class:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"},[x(a(E),{class:"w-4 h-4 mr-2"}),e[0]||(e[0]=C(" Télécharger Excel ",-1))],8,M)]),a(l)?(d(),c("div",N,[x(a(V),{class:"animate-spin h-8 w-8 text-indigo-600"})])):(d(),c("div",q,[t("div",B,[t("table",P,[e[3]||(e[3]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Voiture & Plaque "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Début "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date Fin "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Client "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Coût Total "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contract ID "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Modifier ")])],-1)),t("tbody",A,[a(o).length===0?(d(),c("tr",O,[...e[2]||(e[2]=[t("td",{colspan:"7",class:"px-6 py-4 text-center text-gray-500"}," Aucune réservation trouvée. ",-1)])])):D("",!0),(d(!0),c(T,null,F(a(o),s=>(d(),c("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",U,[t("div",z,r(s.car?.brand)+" "+r(s.car?.model),1),t("div",H,r(s.car?.plate_number),1)]),t("td",Z,r(a(u)(s.start_date)),1),t("td",G,r(a(u)(s.end_date)),1),t("td",J,[t("div",K,r(s.client_name),1)]),t("td",Q,r(s.total_price.toFixed(2))+" TND ",1),t("td",W,r(s.contract_number||"-"),1),t("td",X,[x(a(L),{to:a(m)(`/admin/reservations/${s.id}`),class:"text-indigo-600 hover:text-indigo-900 flex items-center justify-center p-2 rounded-full hover:bg-indigo-50",title:"Modifier"},{default:j(()=>[x(a($),{class:"h-4 w-4"})]),_:1},8,["to"])])]))),128))])])])]))]))}});export{ot as default};
