import{t as se,c as ae,d as ee,u as ne,r as f,a as I,w as F,b as H,o as n,e as d,f as $,g as e,h as W,i as u,j as i,k as ie,l as y,v as D,m as E,F as A,n as R,T as re,s as de,p as ue,q as ce,x as me,y as ge,z as N,A as S,B as G,C as oe,D as k,E as ve,G as pe,H as J,X as fe,I as z,J as xe,K as be,L as ye,M as Q,N as he,O as _e,P as X,Q as we,R as ke,S as $e,U as Ce,_ as De,V as Me,W as Ve}from"./index-C1y38dmy.js";import{u as je}from"./useCars-DEHVUAbi.js";import{u as Le}from"./useReservations-CdySatoD.js";import{f as le,a as Y}from"./date-BpD5EXL9.js";function Z(q,U){const _=+se(q)-+se(U);return _<0?-1:_>0?1:_}/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=ae("ClockIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=ae("KeyIcon",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),Re={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ue={class:"flex min-h-full items-center justify-center p-4"},Ie={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},qe={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},Te={key:0,class:"text-sm text-gray-500 mt-1"},Be={key:0},Oe={key:0,class:"p-6"},Ne={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm"},ze={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ee={class:"flex space-x-2 mt-1"},Fe=["min"],He={class:"flex w-1/2 items-center gap-1"},Je=["value"],We=["value"],Ke={key:0,class:"mt-1 text-xs text-indigo-600 font-medium"},Pe={class:"flex space-x-2 mt-1"},Ge=["min"],Qe={class:"flex w-1/2 items-center gap-1"},Ye=["value"],Ze=["value"],et={key:0,class:"mt-1 text-xs text-indigo-600 font-medium"},tt={key:1,class:"bg-indigo-50 rounded-lg p-4"},st={class:"space-y-2 text-sm"},ot={class:"flex justify-between"},lt={class:"font-medium text-indigo-900"},at={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},nt={class:"mt-4"},rt={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},it=["disabled"],dt={key:0},ut={key:1},ct=ee({__name:"ReservationModal",props:{show:{type:Boolean},car:{}},emits:["close","success"],setup(q,{emit:U}){const _=q,j=U,{createReservation:p,checkAvailability:x,loading:M}=Le(),C=ne(),s=f({client_name:"",client_cin:"",client_phone:"",client_email:C.user?.email||"",start_date:"",end_date:"",price_per_day:150,pickup_location:"",return_location:"",notes:""}),v=f(""),V=f(!1),w=I(()=>{if(!s.value.start_date||!s.value.end_date)return 0;const g=new Date(s.value.start_date),t=new Date(s.value.end_date),o=Math.ceil((t.getTime()-g.getTime())/(1e3*60*60*24));return o>0?o:0}),B=I(()=>w.value*s.value.price_per_day),T=Array.from({length:24},(g,t)=>String(t).padStart(2,"0")),L=["00","30"],h=f(""),c=f("09"),m=f("00"),l=f(""),a=f("09"),r=f("00");F([h,c,m],([g,t,o])=>{if(g&&t&&o){const P=o.padStart(2,"0");s.value.start_date=`${g}T${t}:${P}`}else s.value.start_date=""}),F([l,a,r],([g,t,o])=>{if(g&&t&&o){const P=o.padStart(2,"0");s.value.end_date=`${g}T${t}:${P}`}else s.value.end_date=""}),F(()=>_.show,g=>{g&&(s.value={client_name:"",client_cin:"",client_phone:"",client_email:C.user?.email||"",start_date:"",end_date:"",price_per_day:150,pickup_location:"",return_location:"",notes:""},h.value="",c.value="09",m.value="00",l.value="",a.value="09",r.value="00",v.value="",V.value=!1)});const b=()=>s.value.client_name.trim()?s.value.client_cin.trim()?s.value.client_phone.trim()?s.value.start_date?s.value.end_date?w.value<=0?(v.value="La date de fin doit être après la date de début",!1):(v.value="",!0):(v.value="La date de fin est requise",!1):(v.value="La date de début est requise",!1):(v.value="Le téléphone est requis",!1):(v.value="Le CIN est requis",!1):(v.value="Le nom est requis",!1),K=async()=>{if(!(!b()||!_.car))try{if(!await x(_.car.id,s.value.start_date,s.value.end_date)){v.value="Date deja reservé choisir un autre date";return}await p({user_id:C.user?.id||null,car_id:_.car.id,client_name:s.value.client_name,client_cin:s.value.client_cin,client_phone:s.value.client_phone,client_email:s.value.client_email||null,start_date:s.value.start_date,end_date:s.value.end_date,duration_days:w.value,price_per_day:s.value.price_per_day,total_price:B.value,status:"pending",pickup_location:s.value.pickup_location||null,return_location:s.value.return_location||null,notes:s.value.notes||null}),V.value=!0,setTimeout(()=>{j("success"),j("close")},2e3)}catch(g){v.value=g.message||"Une erreur est survenue"}},O=()=>{j("close")},te=new Date().toISOString().split("T")[0];return(g,t)=>(n(),H(re,{to:"body"},[g.show?(n(),d("div",Re,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:O}),e("div",Ue,[e("div",Ie,[e("div",qe,[e("div",null,[t[13]||(t[13]=e("h2",{class:"text-xl font-semibold text-gray-900"},"Réserver une voiture",-1)),g.car?(n(),d("p",Te,[W(u(g.car.brand)+" "+u(g.car.model)+" ",1),i(C).user?(n(),d("span",Be,"- "+u(g.car.plate_number),1)):$("",!0)])):$("",!0)]),e("button",{onClick:O,class:"text-gray-400 hover:text-gray-500"},[...t[14]||(t[14]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),V.value?(n(),d("div",Oe,[...t[15]||(t[15]=[e("div",{class:"text-center"},[e("div",{class:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100"},[e("svg",{class:"h-8 w-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])]),e("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Réservation envoyée !"),e("p",{class:"mt-2 text-sm text-gray-500"}," Votre demande de réservation a été envoyée avec succès. Vous recevrez une confirmation sous peu. ")],-1)])])):(n(),d("form",{key:1,onSubmit:ie(K,["prevent"]),class:"p-6 space-y-6"},[v.value?(n(),d("div",Ne,u(v.value),1)):$("",!0),e("div",null,[t[20]||(t[20]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations personnelles",-1)),e("div",ze,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom complet *",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.client_name=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Votre nom complet"},null,512),[[D,s.value.client_name]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"CIN *",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.client_cin=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Numéro de carte d'identité"},null,512),[[D,s.value.client_cin]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Téléphone *",-1)),y(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.client_phone=o),type:"tel",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"+216 XX XXX XXX"},null,512),[[D,s.value.client_phone]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.client_email=o),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"votre@email.com"},null,512),[[D,s.value.client_email]])])])]),e("div",null,[t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Dates de location",-1)),e("div",Xe,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date de début *",-1)),e("div",Ee,[y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>h.value=o),type:"date",min:i(te),required:"",class:"block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Fe),[[D,h.value]]),e("div",He,[y(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>c.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(n(!0),d(A,null,R(i(T),o=>(n(),d("option",{key:o,value:o},u(o),9,Je))),128))],512),[[E,c.value]]),t[21]||(t[21]=e("span",{class:"text-gray-500 font-bold"},":",-1)),y(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>m.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(n(),d(A,null,R(L,o=>e("option",{key:o,value:o},u(o),9,We)),64))],512),[[E,m.value]])])]),s.value.start_date?(n(),d("p",Ke,u(i(le)(s.value.start_date)),1)):$("",!0)]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date de fin *",-1)),e("div",Pe,[y(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>l.value=o),type:"date",min:h.value||i(te),required:"",class:"block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Ge),[[D,l.value]]),e("div",Qe,[y(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>a.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(n(!0),d(A,null,R(i(T),o=>(n(),d("option",{key:o,value:o},u(o),9,Ye))),128))],512),[[E,a.value]]),t[23]||(t[23]=e("span",{class:"text-gray-500 font-bold"},":",-1)),y(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>r.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(n(),d(A,null,R(L,o=>e("option",{key:o,value:o},u(o),9,Ze)),64))],512),[[E,r.value]])])]),s.value.end_date?(n(),d("p",et,u(i(le)(s.value.end_date)),1)):$("",!0)])])]),w.value>0?(n(),d("div",tt,[t[27]||(t[27]=e("h3",{class:"text-lg font-medium text-indigo-900 mb-2"},"Récapitulatif",-1)),e("div",st,[e("div",ot,[t[26]||(t[26]=e("span",{class:"text-indigo-700"},"Durée",-1)),e("span",lt,u(w.value)+" jour(s)",1)])])])):$("",!0),e("div",null,[t[31]||(t[31]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations supplémentaires",-1)),e("div",at,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lieu de prise en charge",-1)),y(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>s.value.pickup_location=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Aéroport, agence, etc."},null,512),[[D,s.value.pickup_location]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lieu de retour",-1)),y(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>s.value.return_location=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Aéroport, agence, etc."},null,512),[[D,s.value.return_location]])])]),e("div",nt,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),y(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=o=>s.value.notes=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Informations complémentaires..."},null,512),[[D,s.value.notes]])])]),e("div",rt,[e("button",{type:"button",onClick:O,class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Annuler "),e("button",{type:"submit",disabled:i(M)||w.value<=0,class:"px-4 py-2 bg-indigo-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"},[i(M)?(n(),d("span",dt,"Envoi en cours...")):(n(),d("span",ut,"Confirmer la réservation"))],8,it)])],32))])])])):$("",!0)]))}}),mt={key:0,class:"fixed inset-0 z-[100]",role:"dialog","aria-modal":"true"},gt={class:"fixed inset-0 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 w-full h-full sm:w-[95vw] sm:max-w-[900px] sm:h-auto sm:max-h-[90vh] sm:rounded-2xl bg-white shadow-2xl overflow-hidden flex flex-col"},vt={class:"sticky top-0 z-20 flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b bg-white/95 backdrop-blur-sm"},pt={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},ft={class:"p-1.5 sm:p-2 bg-indigo-100 rounded-lg shrink-0"},xt={class:"min-w-0"},bt={class:"text-sm sm:text-lg font-semibold text-gray-900 truncate"},yt={class:"flex-1 overflow-y-auto overscroll-contain"},ht={class:"p-4 sm:p-6"},_t={class:"min-w-0 flex-1"},wt={key:0,class:"text-xs sm:text-sm text-red-600/80 mt-0.5"},kt={class:"flex flex-col lg:flex-row gap-4 sm:gap-6 lg:gap-8"},$t={class:"flex-1 min-w-0"},Ct={class:"bg-gray-50/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-gray-100"},Dt={class:"flex items-center justify-between mb-3 sm:mb-4"},Mt={class:"text-base sm:text-lg font-semibold text-gray-800 capitalize"},Vt={class:"select-none"},jt={class:"grid grid-cols-7 gap-1 mb-2"},Lt={class:"sm:hidden"},St={class:"hidden sm:inline"},At={class:"grid grid-cols-7 gap-1"},Rt=["datetime"],Ut={class:"lg:w-80 shrink-0"},It={class:"bg-gray-50/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-gray-100 h-full"},qt={class:"flex items-center justify-between mb-3 sm:mb-4"},Tt={class:"text-sm sm:text-base font-semibold text-gray-800 flex items-center gap-2"},Bt={class:"text-xs font-medium text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded-full"},Ot={key:0,class:"flex flex-col items-center justify-center py-8 sm:py-12 text-center"},Nt={class:"p-3 sm:p-4 bg-gray-100 rounded-full mb-3"},zt={key:1,class:"space-y-2 sm:space-y-3 max-h-[200px] lg:max-h-[300px] overflow-y-auto overscroll-contain pr-1 custom-scrollbar"},Xt={class:"flex items-start gap-2 sm:gap-3"},Et={class:"p-1.5 sm:p-2 bg-indigo-50 rounded-lg shrink-0"},Ft={class:"flex-1 min-w-0 space-y-1.5"},Ht={class:"flex items-center gap-1.5 text-xs sm:text-sm text-gray-600"},Jt={class:"truncate"},Wt={class:"flex items-center gap-1.5 text-xs sm:text-sm text-gray-600"},Kt={class:"truncate"},Pt=ee({__name:"CarAvailabilityModal",props:{show:{type:Boolean},car:{}},emits:["close"],setup(q,{emit:U}){const _=q,j=U,p=f(new Date),x=f([]),M=f(!1);F(()=>[_.show,_.car],async([l,a])=>{l&&a&&await C(a.id)},{immediate:!0});async function C(l){M.value=!0;try{const{data:a,error:r}=await Ce.from("reservations").select("start_date, end_date, status").eq("car_id",l).in("status",["confirmed","active"]);if(r)throw r;const b=N(new Date);x.value=(a||[]).filter(K=>{const O=G(S(K.end_date));return Z(O,b)>=0})}catch(a){console.error("Error fetching reservations:",a)}finally{M.value=!1}}const s=I(()=>{const l=de(p.value),a=ue(p.value),r=ce(l,{weekStartsOn:1}),b=me(a,{weekStartsOn:1});return ge({start:r,end:b})});function v(l){return x.value.some(a=>{const r=N(S(a.start_date)),b=G(S(a.end_date));return oe(l,{start:r,end:b})})}const V=I(()=>{const l=new Date;return x.value.find(a=>{const r=N(S(a.start_date)),b=G(S(a.end_date));return oe(l,{start:r,end:b})})}),w=I(()=>{const l=N(new Date);return x.value.filter(r=>{const b=N(S(r.start_date));return Z(b,l)>=0}).sort((r,b)=>Z(S(r.start_date),S(b.start_date)))});function B(){p.value=ke(p.value,1)}function T(){p.value=$e(p.value)}function L(){j("close")}const h=I(()=>!V.value),c=["L","M","M","J","V","S","D"],m=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];return(l,a)=>(n(),H(re,{to:"body"},[k(ve,{"enter-active-class":"transition-opacity duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:pe(()=>[l.show?(n(),d("div",mt,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm","aria-hidden":"true",onClick:L}),e("div",gt,[e("div",vt,[e("div",pt,[e("div",ft,[k(i(J),{class:"w-4 h-4 sm:w-5 sm:h-5 text-indigo-600"})]),e("div",xt,[e("h3",bt,u(l.car?.brand)+" "+u(l.car?.model),1),a[0]||(a[0]=e("p",{class:"text-xs text-gray-500 hidden sm:block"},"Calendrier de disponibilité",-1))])]),e("button",{onClick:L,class:"p-2 -mr-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors touch-manipulation"},[k(i(fe),{class:"h-5 w-5 sm:h-6 sm:w-6 text-gray-500"}),a[1]||(a[1]=e("span",{class:"sr-only"},"Fermer",-1))])]),e("div",yt,[e("div",ht,[e("div",{class:z(["flex items-center gap-3 p-3 sm:p-4 rounded-xl mb-4 sm:mb-6 transition-all",h.value?"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200":"bg-gradient-to-r from-red-50 to-orange-50 border border-red-200"])},[e("div",{class:z(["p-2 sm:p-2.5 rounded-full shrink-0",h.value?"bg-green-100":"bg-red-100"])},[h.value?(n(),H(i(xe),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"})):(n(),H(i(be),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-red-600"}))],2),e("div",_t,[e("p",{class:z(["font-semibold text-sm sm:text-base",h.value?"text-green-700":"text-red-700"])},u(h.value?"✓ Disponible aujourd'hui":"✗ Actuellement Loué"),3),!h.value&&V.value?(n(),d("p",wt," Jusqu'au "+u(i(Y)(V.value.end_date)),1)):$("",!0)])],2),e("div",kt,[e("div",$t,[e("div",Ct,[e("div",Dt,[e("button",{onClick:T,class:"p-2 sm:p-2.5 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation shadow-sm"},[k(i(ye),{class:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})]),e("div",Mt,u(i(Q)(p.value,"MMMM yyyy",{locale:i(he)})),1),e("button",{onClick:B,class:"p-2 sm:p-2.5 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation shadow-sm"},[k(i(_e),{class:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})])]),e("div",Vt,[e("div",jt,[(n(),d(A,null,R(m,(r,b)=>e("div",{key:r,class:"text-center py-2 text-xs sm:text-sm font-medium text-gray-500"},[e("span",Lt,u(c[b]),1),e("span",St,u(r),1)])),64))]),e("div",At,[(n(!0),d(A,null,R(s.value,r=>(n(),d("div",{key:r.toISOString(),class:"relative aspect-square"},[e("div",{class:z(["absolute inset-0.5 sm:inset-1 flex flex-col items-center justify-center rounded-lg sm:rounded-xl transition-all duration-150",[i(X)(r,p.value)?"":"opacity-25",i(we)(r)&&i(X)(r,p.value)?"ring-2 ring-indigo-400 ring-offset-1":"",i(X)(r,p.value)&&v(r)?"bg-red-100 text-red-700":i(X)(r,p.value)?"bg-green-50 text-green-700 hover:bg-green-100":"bg-gray-100 text-gray-400"]])},[e("time",{datetime:i(Q)(r,"yyyy-MM-dd"),class:"text-xs sm:text-sm font-medium"},u(i(Q)(r,"d")),9,Rt),i(X)(r,p.value)?(n(),d("div",{key:0,class:z(["w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full mt-0.5",v(r)?"bg-red-500":"bg-green-500"])},null,2)):$("",!0)],2)]))),128))])]),a[2]||(a[2]=e("div",{class:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-200 flex items-center justify-center gap-4 sm:gap-6"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("span",{class:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-green-500"}),e("span",{class:"text-xs sm:text-sm text-gray-600"},"Disponible")]),e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("span",{class:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-red-500"}),e("span",{class:"text-xs sm:text-sm text-gray-600"},"Réservé")])],-1))])]),e("div",Ut,[e("div",It,[e("div",qt,[e("h4",Tt,[k(i(Se),{class:"w-4 h-4 text-indigo-500"}),a[3]||(a[3]=W(" Réservations à venir ",-1))]),e("span",Bt,u(w.value.length),1)]),w.value.length===0?(n(),d("div",Ot,[e("div",Nt,[k(i(J),{class:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400"})]),a[4]||(a[4]=e("p",{class:"text-sm text-gray-500"},"Aucune réservation",-1)),a[5]||(a[5]=e("p",{class:"text-xs text-gray-400 mt-1"},"Ce véhicule est libre",-1))])):(n(),d("div",zt,[(n(!0),d(A,null,R(w.value,r=>(n(),d("div",{key:r.id,class:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 border border-gray-200 shadow-sm"},[e("div",Xt,[e("div",Et,[k(i(J),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-indigo-600"})]),e("div",Ft,[e("div",Ht,[a[6]||(a[6]=e("span",{class:"w-1.5 h-1.5 rounded-full bg-green-400 shrink-0"},null,-1)),e("span",Jt,u(i(Y)(r.start_date)),1)]),e("div",Wt,[a[7]||(a[7]=e("span",{class:"w-1.5 h-1.5 rounded-full bg-red-400 shrink-0"},null,-1)),e("span",Kt,u(i(Y)(r.end_date)),1)])])])]))),128))]))])])])])]),e("div",{class:"sticky bottom-0 bg-white/95 backdrop-blur-sm px-4 sm:px-6 py-3 sm:py-4 border-t flex justify-end gap-3 safe-bottom"},[e("button",{onClick:L,class:"flex-1 sm:flex-none px-6 py-2.5 sm:py-2 bg-gray-900 text-white text-sm font-medium rounded-xl hover:bg-gray-800 active:bg-gray-950 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 transition-colors touch-manipulation"}," Fermer ")])])])):$("",!0)]),_:1})]))}}),Gt=De(Pt,[["__scopeId","data-v-e1c7cb0b"]]),Qt={class:"min-h-screen bg-gray-100"},Yt={class:"w-full py-6 px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16"},Zt={class:"text-2xl sm:text-3xl font-semibold text-gray-900 mb-6"},es={class:"bg-white p-4 sm:p-5 rounded-xl shadow-sm mb-6 border border-gray-100"},ts={class:"flex flex-col sm:flex-row gap-4"},ss={class:"flex-1"},os=["placeholder"],ls={class:"sm:w-64"},as={value:"all"},ns={value:"disponible"},rs={value:"loue"},is={value:"maintenance"},ds={key:0,class:"text-center py-16"},us={class:"inline-flex items-center gap-3 text-gray-500"},cs={class:"text-lg"},ms={key:1,class:"text-center py-16"},gs={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6"},vs={class:"relative w-full aspect-[4/3] bg-gray-100 overflow-hidden"},ps=["src","alt"],fs={class:"absolute bottom-3 right-3 bg-white rounded-lg p-2 shadow-md"},xs=["src","alt"],bs={class:"p-4 sm:p-5 flex-1 flex flex-col justify-between"},ys={class:"text-lg sm:text-xl font-semibold text-gray-900"},hs={key:0,class:"text-sm text-gray-500 mt-1"},_s={class:"mt-4"},ws={class:"grid grid-cols-2 gap-3"},ks=["onClick"],$s=["onClick"],js=ee({__name:"Home",setup(q){const{cars:U,loading:_,fetchCars:j}=je(),p=ne();Ve();const x=f({search:"",status:"all"}),M=f(!1),C=f(!1),s=f(null);Me(()=>{j()});const v=I(()=>{let c=U.value;if(x.value.status!=="all"&&(c=c.filter(m=>m.status===x.value.status)),x.value.search){const m=x.value.search.toLowerCase();c=c.filter(l=>l.brand.toLowerCase().includes(m)||l.model.toLowerCase().includes(m)||l.plate_number.toLowerCase().includes(m))}return c}),V=c=>`/images/${c}.png`,w=c=>{s.value=c,C.value=!0},B=()=>{C.value=!1,s.value=null},T=c=>{s.value=c,M.value=!0},L=()=>{M.value=!1,s.value=null},h=()=>{j()};return(c,m)=>(n(),d("div",Qt,[e("main",Yt,[e("div",null,[e("h1",Zt,u(c.$t("fleet.title")),1),e("div",es,[e("div",ts,[e("div",ss,[y(e("input",{"onUpdate:modelValue":m[0]||(m[0]=l=>x.value.search=l),type:"text",placeholder:c.$t("fleet.search_placeholder"),class:"border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-base py-3 px-4"},null,8,os),[[D,x.value.search]])]),e("div",ls,[y(e("select",{"onUpdate:modelValue":m[1]||(m[1]=l=>x.value.status=l),class:"border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-base py-3 px-4"},[e("option",as,u(c.$t("fleet.all_statuses")),1),e("option",ns,u(c.$t("admin.fleet.disponible")),1),e("option",rs,u(c.$t("admin.fleet.loue")),1),e("option",is,u(c.$t("admin.fleet.maintenance")),1)],512),[[E,x.value.status]])])])]),i(_)?(n(),d("div",ds,[e("div",us,[m[2]||(m[2]=e("svg",{class:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e("span",cs,u(c.$t("fleet.loading")),1)])])):v.value.length===0?(n(),d("div",ms,[...m[3]||(m[3]=[e("p",{class:"text-gray-500 text-lg"},"Aucune voiture trouvée.",-1)])])):(n(),d("div",gs,[(n(!0),d(A,null,R(v.value,l=>(n(),d("div",{key:l.id,class:"group bg-white rounded-xl shadow-sm hover:shadow-lg overflow-hidden flex flex-col h-full transition-all duration-300 border border-gray-100 hover:border-indigo-200"},[e("div",vs,[e("img",{src:l.image_url||"https://via.placeholder.com/400x300?text=No+Image",alt:`${l.brand} ${l.model}`,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"},null,8,ps),e("div",fs,[e("img",{src:V(l.brand),alt:l.brand,class:"h-8 w-8 object-contain"},null,8,xs)])]),e("div",bs,[e("div",null,[e("h3",ys,u(l.brand)+" "+u(l.model),1),i(p).user?(n(),d("p",hs,u(l.plate_number),1)):$("",!0)]),e("div",_s,[e("div",ws,[e("button",{onClick:a=>w(l),class:"flex items-center justify-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"},[k(i(J),{class:"w-4 h-4 mr-2"}),m[4]||(m[4]=W(" Dispo ",-1))],8,ks),e("button",{onClick:a=>T(l),class:"flex items-center justify-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"},[k(i(Ae),{class:"w-4 h-4 mr-2"}),m[5]||(m[5]=W(" Réserver ",-1))],8,$s)])])])]))),128))]))])]),k(ct,{show:M.value,car:s.value,onClose:L,onSuccess:h},null,8,["show","car"]),k(Gt,{show:C.value,car:s.value,onClose:B},null,8,["show","car"])]))}});export{js as default};
