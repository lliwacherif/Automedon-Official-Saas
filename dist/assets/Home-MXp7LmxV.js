import{t as se,c as ne,d as ee,u as te,r as x,a as I,w as W,b as K,o as l,e as r,f as k,g as e,h as F,i as d,j as n,k as ie,l as y,v as M,m as E,F as L,n as A,T as re,s as de,p as ue,q as ce,x as me,y as ge,z as j,A as oe,B as J,C as w,D as ve,E as pe,G as P,X as fe,H as z,I as xe,J as be,K as ye,L as Q,M as he,N as _e,O as X,P as we,Q as le,R as ke,S as $e,U as Ce,_ as De,V as Me,W as Ve}from"./index-BlVnYu75.js";import{u as Se}from"./useCars-BkAsT5Lt.js";import{u as je}from"./useReservations-DSglpFzk.js";import{f as ae,a as Y}from"./date-BpD5EXL9.js";function Z(q,R){const _=+se(q)-+se(R);return _<0?-1:_>0?1:_}/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=ne("ClockIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=ne("KeyIcon",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),Re={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ue={class:"flex min-h-full items-center justify-center p-4"},Ie={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},qe={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},Te={key:0,class:"text-sm text-gray-500 mt-1"},Be={key:0},Oe={key:0,class:"p-6"},Ne={key:0,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm"},ze={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ee={class:"flex space-x-2 mt-1"},Fe=["min"],He={class:"flex w-1/2 items-center gap-1"},Je=["value"],We=["value"],Ke={key:0,class:"mt-1 text-xs text-indigo-600 font-medium"},Pe={class:"flex space-x-2 mt-1"},Ge=["min"],Qe={class:"flex w-1/2 items-center gap-1"},Ye=["value"],Ze=["value"],et={key:0,class:"mt-1 text-xs text-indigo-600 font-medium"},tt={key:1,class:"bg-indigo-50 rounded-lg p-4"},st={class:"space-y-2 text-sm"},ot={class:"flex justify-between"},lt={class:"font-medium text-indigo-900"},at={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},nt={class:"mt-4"},rt={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},it=["disabled"],dt={key:0},ut={key:1},ct=ee({__name:"ReservationModal",props:{show:{type:Boolean},car:{}},emits:["close","success"],setup(q,{emit:R}){const _=q,V=R,{createReservation:O,checkAvailability:g,loading:$}=je(),C=te(),s=x({client_name:"",client_cin:"",client_phone:"",client_email:C.user?.email||"",start_date:"",end_date:"",price_per_day:150,pickup_location:"",return_location:"",notes:""}),f=x(""),S=x(!1),h=I(()=>{if(!s.value.start_date||!s.value.end_date)return 0;const p=new Date(s.value.start_date),t=new Date(s.value.end_date),o=Math.ceil((t.getTime()-p.getTime())/(1e3*60*60*24));return o>0?o:0}),U=I(()=>h.value*s.value.price_per_day),T=Array.from({length:24},(p,t)=>String(t).padStart(2,"0")),B=["00","30"],D=x(""),u=x("09"),m=x("00"),c=x(""),v=x("09"),a=x("00");W([D,u,m],([p,t,o])=>{if(p&&t&&o){const G=o.padStart(2,"0");s.value.start_date=`${p}T${t}:${G}`}else s.value.start_date=""}),W([c,v,a],([p,t,o])=>{if(p&&t&&o){const G=o.padStart(2,"0");s.value.end_date=`${p}T${t}:${G}`}else s.value.end_date=""}),W(()=>_.show,p=>{p&&(s.value={client_name:"",client_cin:"",client_phone:"",client_email:C.user?.email||"",start_date:"",end_date:"",price_per_day:150,pickup_location:"",return_location:"",notes:""},D.value="",u.value="09",m.value="00",c.value="",v.value="09",a.value="00",f.value="",S.value=!1)});const i=()=>s.value.client_name.trim()?s.value.client_cin.trim()?s.value.client_phone.trim()?s.value.start_date?s.value.end_date?h.value<=0?(f.value="La date de fin doit être après la date de début",!1):(f.value="",!0):(f.value="La date de fin est requise",!1):(f.value="La date de début est requise",!1):(f.value="Le téléphone est requis",!1):(f.value="Le CIN est requis",!1):(f.value="Le nom est requis",!1),b=async()=>{if(!(!i()||!_.car))try{if(!await g(_.car.id,s.value.start_date,s.value.end_date)){f.value="Date deja reservé choisir un autre date";return}await O({user_id:C.user?.id||null,car_id:_.car.id,client_name:s.value.client_name,client_cin:s.value.client_cin,client_phone:s.value.client_phone,client_email:s.value.client_email||null,start_date:s.value.start_date,end_date:s.value.end_date,duration_days:h.value,price_per_day:s.value.price_per_day,total_price:U.value,status:"pending",pickup_location:s.value.pickup_location||null,return_location:s.value.return_location||null,notes:s.value.notes||null}),S.value=!0,setTimeout(()=>{V("success"),V("close")},2e3)}catch(p){f.value=p.message||"Une erreur est survenue"}},N=()=>{V("close")},H=new Date().toISOString().split("T")[0];return(p,t)=>(l(),K(re,{to:"body"},[p.show?(l(),r("div",Re,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:N}),e("div",Ue,[e("div",Ie,[e("div",qe,[e("div",null,[t[13]||(t[13]=e("h2",{class:"text-xl font-semibold text-gray-900"},"Réserver une voiture",-1)),p.car?(l(),r("p",Te,[F(d(p.car.brand)+" "+d(p.car.model)+" ",1),n(C).user?(l(),r("span",Be,"- "+d(p.car.plate_number),1)):k("",!0)])):k("",!0)]),e("button",{onClick:N,class:"text-gray-400 hover:text-gray-500"},[...t[14]||(t[14]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),S.value?(l(),r("div",Oe,[...t[15]||(t[15]=[e("div",{class:"text-center"},[e("div",{class:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100"},[e("svg",{class:"h-8 w-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])]),e("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Réservation envoyée !"),e("p",{class:"mt-2 text-sm text-gray-500"}," Votre demande de réservation a été envoyée avec succès. Vous recevrez une confirmation sous peu. ")],-1)])])):(l(),r("form",{key:1,onSubmit:ie(b,["prevent"]),class:"p-6 space-y-6"},[f.value?(l(),r("div",Ne,d(f.value),1)):k("",!0),e("div",null,[t[20]||(t[20]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations personnelles",-1)),e("div",ze,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom complet *",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.client_name=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Votre nom complet"},null,512),[[M,s.value.client_name]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"CIN *",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.client_cin=o),type:"text",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Numéro de carte d'identité"},null,512),[[M,s.value.client_cin]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Téléphone *",-1)),y(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.client_phone=o),type:"tel",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"+216 XX XXX XXX"},null,512),[[M,s.value.client_phone]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.client_email=o),type:"email",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"votre@email.com"},null,512),[[M,s.value.client_email]])])])]),e("div",null,[t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Dates de location",-1)),e("div",Xe,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date de début *",-1)),e("div",Ee,[y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>D.value=o),type:"date",min:n(H),required:"",class:"block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Fe),[[M,D.value]]),e("div",He,[y(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>u.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(l(!0),r(L,null,A(n(T),o=>(l(),r("option",{key:o,value:o},d(o),9,Je))),128))],512),[[E,u.value]]),t[21]||(t[21]=e("span",{class:"text-gray-500 font-bold"},":",-1)),y(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>m.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(l(),r(L,null,A(B,o=>e("option",{key:o,value:o},d(o),9,We)),64))],512),[[E,m.value]])])]),s.value.start_date?(l(),r("p",Ke,d(n(ae)(s.value.start_date)),1)):k("",!0)]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date de fin *",-1)),e("div",Pe,[y(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>c.value=o),type:"date",min:D.value||n(H),required:"",class:"block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,Ge),[[M,c.value]]),e("div",Qe,[y(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>v.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(l(!0),r(L,null,A(n(T),o=>(l(),r("option",{key:o,value:o},d(o),9,Ye))),128))],512),[[E,v.value]]),t[23]||(t[23]=e("span",{class:"text-gray-500 font-bold"},":",-1)),y(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.value=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm px-0 text-center"},[(l(),r(L,null,A(B,o=>e("option",{key:o,value:o},d(o),9,Ze)),64))],512),[[E,a.value]])])]),s.value.end_date?(l(),r("p",et,d(n(ae)(s.value.end_date)),1)):k("",!0)])])]),h.value>0?(l(),r("div",tt,[t[27]||(t[27]=e("h3",{class:"text-lg font-medium text-indigo-900 mb-2"},"Récapitulatif",-1)),e("div",st,[e("div",ot,[t[26]||(t[26]=e("span",{class:"text-indigo-700"},"Durée",-1)),e("span",lt,d(h.value)+" jour(s)",1)])])])):k("",!0),e("div",null,[t[31]||(t[31]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations supplémentaires",-1)),e("div",at,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lieu de prise en charge",-1)),y(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>s.value.pickup_location=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Aéroport, agence, etc."},null,512),[[M,s.value.pickup_location]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Lieu de retour",-1)),y(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>s.value.return_location=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Aéroport, agence, etc."},null,512),[[M,s.value.return_location]])])]),e("div",nt,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),y(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=o=>s.value.notes=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Informations complémentaires..."},null,512),[[M,s.value.notes]])])]),e("div",rt,[e("button",{type:"button",onClick:N,class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Annuler "),e("button",{type:"submit",disabled:n($)||h.value<=0,class:"px-4 py-2 bg-indigo-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"},[n($)?(l(),r("span",dt,"Envoi en cours...")):(l(),r("span",ut,"Confirmer la réservation"))],8,it)])],32))])])])):k("",!0)]))}}),mt={key:0,class:"fixed inset-0 z-[100]",role:"dialog","aria-modal":"true"},gt={class:"fixed inset-0 sm:inset-auto sm:top-1/2 sm:left-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 w-full h-full sm:w-[95vw] sm:max-w-[900px] sm:h-auto sm:max-h-[90vh] sm:rounded-2xl bg-white shadow-2xl overflow-hidden flex flex-col"},vt={class:"sticky top-0 z-20 flex items-center justify-between px-4 sm:px-6 py-3 sm:py-4 border-b bg-white/95 backdrop-blur-sm"},pt={class:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1"},ft={class:"p-1.5 sm:p-2 bg-indigo-100 rounded-lg shrink-0"},xt={class:"min-w-0"},bt={class:"text-sm sm:text-lg font-semibold text-gray-900 truncate"},yt={key:0,class:"ml-2 text-gray-500 font-normal text-sm"},ht={class:"flex-1 overflow-y-auto overscroll-contain"},_t={class:"p-4 sm:p-6"},wt={class:"min-w-0 flex-1"},kt={key:0,class:"text-xs sm:text-sm text-red-600/80 mt-0.5"},$t={class:"flex flex-col lg:flex-row gap-4 sm:gap-6 lg:gap-8"},Ct={class:"flex-1 min-w-0"},Dt={class:"bg-gray-50/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-gray-100"},Mt={class:"flex items-center justify-between mb-3 sm:mb-4"},Vt={class:"text-base sm:text-lg font-semibold text-gray-800 capitalize"},St={class:"select-none"},jt={class:"grid grid-cols-7 gap-1 mb-2"},Lt={class:"sm:hidden"},At={class:"hidden sm:inline"},Rt={class:"grid grid-cols-7 gap-1"},Ut=["datetime"],It={class:"lg:w-80 shrink-0"},qt={class:"bg-gray-50/50 rounded-xl sm:rounded-2xl p-3 sm:p-4 border border-gray-100 h-full"},Tt={class:"flex items-center justify-between mb-3 sm:mb-4"},Bt={class:"text-sm sm:text-base font-semibold text-gray-800 flex items-center gap-2"},Ot={class:"text-xs font-medium text-indigo-600 bg-indigo-100 px-2 py-0.5 rounded-full"},Nt={key:0,class:"flex flex-col items-center justify-center py-8 sm:py-12 text-center"},zt={class:"p-3 sm:p-4 bg-gray-100 rounded-full mb-3"},Xt={key:1,class:"space-y-2 sm:space-y-3 max-h-[200px] lg:max-h-[300px] overflow-y-auto overscroll-contain pr-1 custom-scrollbar"},Et={class:"flex items-start gap-2 sm:gap-3"},Ft={class:"p-1.5 sm:p-2 bg-indigo-50 rounded-lg shrink-0"},Ht={class:"flex-1 min-w-0 space-y-1.5"},Jt={class:"flex items-center gap-1.5 text-xs sm:text-sm text-gray-600"},Wt={class:"truncate"},Kt={class:"flex items-center gap-1.5 text-xs sm:text-sm text-gray-600"},Pt={class:"truncate"},Gt=ee({__name:"CarAvailabilityModal",props:{show:{type:Boolean},car:{}},emits:["close"],setup(q,{emit:R}){const _=q,V=R,O=te(),g=x(new Date),$=x([]),C=x(!1);W(()=>[_.show,_.car],async([v,a])=>{v&&a&&await s(a.id)},{immediate:!0});async function s(v){C.value=!0;try{const{data:a,error:i}=await Ce.from("reservations").select("id, start_date, end_date, status").eq("car_id",v).in("status",["confirmed","active"]);if(i)throw i;const b=J(new Date);$.value=(a||[]).filter(N=>{const H=le(j(N.end_date));return Z(H,b)>=0})}catch(a){console.error("Error fetching reservations:",a)}finally{C.value=!1}}const f=I(()=>{const v=de(g.value),a=ue(g.value),i=ce(v,{weekStartsOn:1}),b=me(a,{weekStartsOn:1});return ge({start:i,end:b})});function S(v){return $.value.some(a=>{const i=J(j(a.start_date)),b=le(j(a.end_date));return oe(v,{start:i,end:b})})}const h=I(()=>{const v=new Date;return $.value.find(a=>{const i=j(a.start_date),b=j(a.end_date);return oe(v,{start:i,end:b})})}),U=I(()=>{const v=J(new Date);return $.value.filter(i=>{if(h.value&&i.id===h.value.id)return!1;const b=J(j(i.start_date));return Z(b,v)>=0}).sort((i,b)=>Z(j(i.start_date),j(b.start_date)))});function T(){g.value=ke(g.value,1)}function B(){g.value=$e(g.value)}function D(){V("close")}const u=I(()=>!h.value),m=["L","M","M","J","V","S","D"],c=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];return(v,a)=>(l(),K(re,{to:"body"},[w(ve,{"enter-active-class":"transition-opacity duration-200 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-150 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:pe(()=>[v.show?(l(),r("div",mt,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm","aria-hidden":"true",onClick:D}),e("div",gt,[e("div",vt,[e("div",pt,[e("div",ft,[w(n(P),{class:"w-4 h-4 sm:w-5 sm:h-5 text-indigo-600"})]),e("div",xt,[e("h3",bt,[F(d(v.car?.brand)+" "+d(v.car?.model)+" ",1),n(O).isAdmin?(l(),r("span",yt,d(v.car?.plate_number),1)):k("",!0)]),a[0]||(a[0]=e("p",{class:"text-xs text-gray-500 hidden sm:block"},"Calendrier de disponibilité",-1))])]),e("button",{onClick:D,class:"p-2 -mr-2 rounded-full hover:bg-gray-100 active:bg-gray-200 transition-colors touch-manipulation"},[w(n(fe),{class:"h-5 w-5 sm:h-6 sm:w-6 text-gray-500"}),a[1]||(a[1]=e("span",{class:"sr-only"},"Fermer",-1))])]),e("div",ht,[e("div",_t,[e("div",{class:z(["flex items-center gap-3 p-3 sm:p-4 rounded-xl mb-4 sm:mb-6 transition-all",u.value?"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200":"bg-gradient-to-r from-red-50 to-orange-50 border border-red-200"])},[e("div",{class:z(["p-2 sm:p-2.5 rounded-full shrink-0",u.value?"bg-green-100":"bg-red-100"])},[u.value?(l(),K(n(xe),{key:0,class:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"})):(l(),K(n(be),{key:1,class:"w-4 h-4 sm:w-5 sm:h-5 text-red-600"}))],2),e("div",wt,[e("p",{class:z(["font-semibold text-sm sm:text-base",u.value?"text-green-700":"text-red-700"])},d(u.value?"✓ Disponible aujourd'hui":"✗ Actuellement Loué"),3),!u.value&&h.value?(l(),r("p",kt," Jusqu'au "+d(n(Y)(h.value.end_date)),1)):k("",!0)])],2),e("div",$t,[e("div",Ct,[e("div",Dt,[e("div",Mt,[e("button",{onClick:B,class:"p-2 sm:p-2.5 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation shadow-sm"},[w(n(ye),{class:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})]),e("div",Vt,d(n(Q)(g.value,"MMMM yyyy",{locale:n(he)})),1),e("button",{onClick:T,class:"p-2 sm:p-2.5 rounded-xl bg-white border border-gray-200 hover:bg-gray-50 active:bg-gray-100 transition-colors touch-manipulation shadow-sm"},[w(n(_e),{class:"h-4 w-4 sm:h-5 sm:w-5 text-gray-600"})])]),e("div",St,[e("div",jt,[(l(),r(L,null,A(c,(i,b)=>e("div",{key:i,class:"text-center py-2 text-xs sm:text-sm font-medium text-gray-500"},[e("span",Lt,d(m[b]),1),e("span",At,d(i),1)])),64))]),e("div",Rt,[(l(!0),r(L,null,A(f.value,i=>(l(),r("div",{key:i.toISOString(),class:"relative aspect-square"},[e("div",{class:z(["absolute inset-0.5 sm:inset-1 flex flex-col items-center justify-center rounded-lg sm:rounded-xl transition-all duration-150",[n(X)(i,g.value)?"":"opacity-25",n(we)(i)&&n(X)(i,g.value)?"ring-2 ring-indigo-400 ring-offset-1":"",n(X)(i,g.value)&&S(i)?"bg-red-100 text-red-700":n(X)(i,g.value)?"bg-green-50 text-green-700 hover:bg-green-100":"bg-gray-100 text-gray-400"]])},[e("time",{datetime:n(Q)(i,"yyyy-MM-dd"),class:"text-xs sm:text-sm font-medium"},d(n(Q)(i,"d")),9,Ut),n(X)(i,g.value)?(l(),r("div",{key:0,class:z(["w-1 h-1 sm:w-1.5 sm:h-1.5 rounded-full mt-0.5",S(i)?"bg-red-500":"bg-green-500"])},null,2)):k("",!0)],2)]))),128))])]),a[2]||(a[2]=e("div",{class:"mt-3 sm:mt-4 pt-3 sm:pt-4 border-t border-gray-200 flex items-center justify-center gap-4 sm:gap-6"},[e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("span",{class:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-green-500"}),e("span",{class:"text-xs sm:text-sm text-gray-600"},"Disponible")]),e("div",{class:"flex items-center gap-1.5 sm:gap-2"},[e("span",{class:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full bg-red-500"}),e("span",{class:"text-xs sm:text-sm text-gray-600"},"Réservé")])],-1))])]),e("div",It,[e("div",qt,[e("div",Tt,[e("h4",Bt,[w(n(Le),{class:"w-4 h-4 text-indigo-500"}),a[3]||(a[3]=F(" Réservations à venir ",-1))]),e("span",Ot,d(U.value.length),1)]),U.value.length===0?(l(),r("div",Nt,[e("div",zt,[w(n(P),{class:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400"})]),a[4]||(a[4]=e("p",{class:"text-sm text-gray-500"},"Aucune réservation",-1)),a[5]||(a[5]=e("p",{class:"text-xs text-gray-400 mt-1"},"Ce véhicule est libre",-1))])):(l(),r("div",Xt,[(l(!0),r(L,null,A(U.value,i=>(l(),r("div",{key:i.id,class:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 border border-gray-200 shadow-sm"},[e("div",Et,[e("div",Ft,[w(n(P),{class:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-indigo-600"})]),e("div",Ht,[e("div",Jt,[a[6]||(a[6]=e("span",{class:"w-1.5 h-1.5 rounded-full bg-green-400 shrink-0"},null,-1)),e("span",Wt,d(n(Y)(i.start_date)),1)]),e("div",Kt,[a[7]||(a[7]=e("span",{class:"w-1.5 h-1.5 rounded-full bg-red-400 shrink-0"},null,-1)),e("span",Pt,d(n(Y)(i.end_date)),1)])])])]))),128))]))])])])])]),e("div",{class:"sticky bottom-0 bg-white/95 backdrop-blur-sm px-4 sm:px-6 py-3 sm:py-4 border-t flex justify-end gap-3 safe-bottom"},[e("button",{onClick:D,class:"flex-1 sm:flex-none px-6 py-2.5 sm:py-2 bg-gray-900 text-white text-sm font-medium rounded-xl hover:bg-gray-800 active:bg-gray-950 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 transition-colors touch-manipulation"}," Fermer ")])])])):k("",!0)]),_:1})]))}}),Qt=De(Gt,[["__scopeId","data-v-cad6b9c8"]]),Yt={class:"min-h-screen bg-gray-100"},Zt={class:"w-full py-6 px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16"},es={class:"text-2xl sm:text-3xl font-semibold text-gray-900 mb-6"},ts={class:"bg-white p-4 sm:p-5 rounded-xl shadow-sm mb-6 border border-gray-100"},ss={class:"flex flex-col sm:flex-row gap-4"},os={class:"flex-1"},ls=["placeholder"],as={class:"sm:w-64"},ns={value:"all"},rs={value:"disponible"},is={value:"loue"},ds={value:"maintenance"},us={key:0,class:"text-center py-16"},cs={class:"inline-flex items-center gap-3 text-gray-500"},ms={class:"text-lg"},gs={key:1,class:"text-center py-16"},vs={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6"},ps={class:"relative w-full aspect-[4/3] bg-gray-100 overflow-hidden"},fs=["src","alt"],xs={class:"absolute bottom-3 right-3 bg-white rounded-lg p-2 shadow-md"},bs=["src","alt"],ys={class:"p-4 sm:p-5 flex-1 flex flex-col justify-between"},hs={class:"text-lg sm:text-xl font-semibold text-gray-900"},_s={key:0,class:"text-sm text-gray-500 mt-1"},ws={class:"mt-4"},ks={class:"grid grid-cols-2 gap-3"},$s=["onClick"],Cs=["onClick"],js=ee({__name:"Home",setup(q){const{cars:R,loading:_,fetchCars:V}=Se(),O=te();Ve();const g=x({search:"",status:"all"}),$=x(!1),C=x(!1),s=x(null);Me(()=>{V()});const f=I(()=>{let u=R.value;if(g.value.status!=="all"&&(u=u.filter(m=>m.status===g.value.status)),g.value.search){const m=g.value.search.toLowerCase();u=u.filter(c=>c.brand.toLowerCase().includes(m)||c.model.toLowerCase().includes(m)||c.plate_number.toLowerCase().includes(m))}return u}),S=u=>`/images/${u}.png`,h=u=>{s.value=u,C.value=!0},U=()=>{C.value=!1,s.value=null},T=u=>{s.value=u,$.value=!0},B=()=>{$.value=!1,s.value=null},D=()=>{V()};return(u,m)=>(l(),r("div",Yt,[e("main",Zt,[e("div",null,[e("h1",es,d(u.$t("fleet.title")),1),e("div",ts,[e("div",ss,[e("div",os,[y(e("input",{"onUpdate:modelValue":m[0]||(m[0]=c=>g.value.search=c),type:"text",placeholder:u.$t("fleet.search_placeholder"),class:"border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-base py-3 px-4"},null,8,ls),[[M,g.value.search]])]),e("div",as,[y(e("select",{"onUpdate:modelValue":m[1]||(m[1]=c=>g.value.status=c),class:"border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full text-base py-3 px-4"},[e("option",ns,d(u.$t("fleet.all_statuses")),1),e("option",rs,d(u.$t("admin.fleet.disponible")),1),e("option",is,d(u.$t("admin.fleet.loue")),1),e("option",ds,d(u.$t("admin.fleet.maintenance")),1)],512),[[E,g.value.status]])])])]),n(_)?(l(),r("div",us,[e("div",cs,[m[2]||(m[2]=e("svg",{class:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),e("span",ms,d(u.$t("fleet.loading")),1)])])):f.value.length===0?(l(),r("div",gs,[...m[3]||(m[3]=[e("p",{class:"text-gray-500 text-lg"},"Aucune voiture trouvée.",-1)])])):(l(),r("div",vs,[(l(!0),r(L,null,A(f.value,c=>(l(),r("div",{key:c.id,class:"group bg-white rounded-xl shadow-sm hover:shadow-lg overflow-hidden flex flex-col h-full transition-all duration-300 border border-gray-100 hover:border-indigo-200"},[e("div",ps,[e("img",{src:c.image_url||"https://via.placeholder.com/400x300?text=No+Image",alt:`${c.brand} ${c.model}`,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"},null,8,fs),e("div",xs,[e("img",{src:S(c.brand),alt:c.brand,class:"h-8 w-8 object-contain"},null,8,bs)])]),e("div",ys,[e("div",null,[e("h3",hs,d(c.brand)+" "+d(c.model),1),n(O).user?(l(),r("p",_s,d(c.plate_number),1)):k("",!0)]),e("div",ws,[e("div",ks,[e("button",{onClick:v=>h(c),class:"flex items-center justify-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"},[w(n(P),{class:"w-4 h-4 mr-2"}),m[4]||(m[4]=F(" Dispo ",-1))],8,$s),e("button",{onClick:v=>T(c),class:"flex items-center justify-center px-3 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"},[w(n(Ae),{class:"w-4 h-4 mr-2"}),m[5]||(m[5]=F(" Réserver ",-1))],8,Cs)])])])]))),128))]))])]),w(ct,{show:$.value,car:s.value,onClose:B,onSuccess:D},null,8,["show","car"]),w(Qt,{show:C.value,car:s.value,onClose:U},null,8,["show","car"])]))}});export{js as default};
